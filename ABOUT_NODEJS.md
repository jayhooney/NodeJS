## JS Rutime

- NodeJS는 V8, libuv 라이브러리를 사용한다.
- libuv 라이브러리는 NodeJS의 특징인 이벤트 기반, 논블로킹 I/O 모델을 구현. 이 덕분에 NodeJS는 **가볍고 효율적**이다.

## 이벤트 기반?

- 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식
- 노드는 코드를 맨 위 한 줄씩 실행하는데, 함수 호출 부분을 반견하면 호출한 함수를 호출 스택에 넣는다. 실제 실행될 땐 호출된 순서와 반대로 실행이 완료된다.
- **테스크 큐** : 콜백함수들이 기다리는 공간. 이벤트 루프가 정한 순서대로 줄서있어서 콜백 큐라고도 한다.
- **백그라운드** : 타이머나 I/O 작업 콜백 또는 이벤트 리스너가 대기하는 곳.

## 논블로킹 I/O

- 처리가 오래걸리는 함수를 백그라운드로 보내 다음 코드가 먼저 실행되게끔 하고, 그 함수를 다시 테스크 큐를 거쳐 호출 스택으로 올라오길 기다리는 방식.
- 블로킹 보단 논블로킹 방식이 같은 작업을 더 짧은 시간에 해결한다.
- 싱글스레드만 사용하기 떄문에 노드 프로세스 외 다른 컴퓨팅 자원을 사용할 수 있는 I/O작업(파일시스템, 네트워크 요청 등)이 주로 시간적 이득을 본다.

## 싱글스레드 기반인데, 이게 어떻게 서버로서 작동하는가?

- 클러스터/포크 개념으로 멀티프로세싱 처리를 하면 된다.
- pm2라는 훌륭한 Node Process 매니징 모듈이 있다.

## Callback

- "이거 여유 될 때 알아서 처리해줘." 가 콜백.
- 콜백이 콜백을 호출하는 아주 미래 레거시적 상황을 발생시키는 지옥같은 로직을 콜백 지옥이라 함.

## Promise

- JS 비동기 처리에 사용되는 객체.
- func().then().catch() 체이닝으로 예외처리 가능.
- async/await 은 Promise를 편하게 쓰기 위한 문법.
- Promise의 뜻은 '약속(=보장)'이다. 즉, 이 처리가 끝나는것을 보장해야할 때 사용한다.

## NodeJS의 장/단점

### 1. 장점

- 당연하게도 멀티스레드 방식보단 컴퓨팅 자원을 적게 사용
- I/O작업이 많은 서버로 적합
- 개발이 비교적 쉬움

### 2. 단점

- CPU코어를 하나만 사용해서, CPU작업이 많은 처리를 해야할 땐 부적합.
- 로직잘못짜면 로그에 undefined를 찍는 대참사가 발생할 수 있다.
- 콜백함수 잘못쓰면 지옥을 맛보기 딱 좋다. Promise, async/await 도 마찬가지.
